//LIBRERIE STANDARD
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <math.h>
//FILE HEADER AGGIUNTIVI (Funzioni)
#include "input_ip.h"
#include "output_ip.h"
#include "conversione_decimale_binario_ip.h"
#include "conversione_binario_decimale.h"
#include "controllo_tipo_ip.h"
#include "creatore_sottoreti_flsm.h"
#include "creatore_sottoreti_vlsm.h"
#include "creatore_sottoreti_flsm_file.h"
#include "creatore_sottoreti_vlsm_file.h"
#include "controllo_stessa_subnet.h"
#include "clearscreen.h"


int main(){
	int ip_bin[32];
	int ip_dec[4];
	int scelta;
	int scelta_file;
	int fine;
	int tipo;
	char banner[479] = {0x27, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x27, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x3a, 0x27, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x3a, 0x27, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x27, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x3a, 0x27, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x0a, 0x2e, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x2e, 0x2e, 0x2e, 0x2e, 0x20, 0x23, 0x23, 0x3a, 0x2e, 0x2e, 0x2e, 0x20, 0x23, 0x23, 0x2e, 0x2e, 0x3a, 0x3a, 0x27, 0x23, 0x23, 0x2e, 0x2e, 0x2e, 0x2e, 0x20, 0x23, 0x23, 0x3a, 0x27, 0x23, 0x23, 0x2e, 0x2e, 0x2e, 0x2e, 0x20, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x0a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x0a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x0a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x0a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x0a, 0x27, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x3a, 0x3a, 0x3a, 0x3a, 0x2e, 0x20, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x3a, 0x2e, 0x20, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x3a, 0x20, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x3a, 0x0a, 0x2e, 0x2e, 0x2e, 0x2e, 0x3a, 0x3a, 0x2e, 0x2e, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x2e, 0x2e, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x3a, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x3a, 0x3a, 0x3a, 0x3a, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x3a, 0x3a, 0x3a, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x2e, 0x3a, 0x3a}; //Banner
	fine = 0;
	puts(banner);
	sleep(2);
	printf("\n\tUn programma creato da Jacopo Rossetti\n");
	sleep(2);
	clearscreen(); //Pulizia schermo
	do{
		printf("1) Inserisci un indirizzo ipv4 e calcolane la sua classe e il suo corrispettivo ip in binario\n2) Crea un numero di sottoreti a tua scelta con la FLSM\n3) Crea un numero di sottoreti a tua scelta con la VLSM\n4) Verifica se 2 indirizzi appartengono alla stessa subnet\n5) Fine\nFai la tua scelta: ");
		scanf("%d", &scelta);
		switch(scelta){
			case 1:
				input_ip(ip_dec);
    			printf("L'indirizzo inserito e' il seguente: ");
    			output_ip_dec(ip_dec);	
				printf("\n");
				controllo_tipo_ip(ip_dec);
				conversione_decimale_binario(ip_dec, ip_bin);
    			printf("\nL'indirizzo ip in binario e' il seguente: \n");
				output_ip_bin(ip_bin);
				break;
			case 2:
				input_ip(ip_dec);
 				tipo = controllo_tipo_ip_sottorete(ip_dec);
				printf("1) Output normale\n2) Output su file\nFai la tua scelta: ");
				scanf("%d", &scelta_file);
				switch(scelta_file){
					case 1:
						switch(tipo){
							case 0:
								creatore_sottoreti_a(ip_dec);
								break;
							case 1:
								creatore_sottoreti_b(ip_dec);
								break;
							case 2:
								creatore_sottoreti_c(ip_dec);
								break;
						}
						break;
					case 2:
						switch(tipo){
							case 0:
								creatore_sottoreti_a_file(ip_dec);
								break;
							case 1:
								creatore_sottoreti_b_file(ip_dec);
								break;
							case 2:
								creatore_sottoreti_c_file(ip_dec);
								break;
						}
						break;
					default:
						printf("Input non valido\n");
						break;
				}					
				break;
			case 3:
				input_ip(ip_dec);
 				tipo = controllo_tipo_ip_sottorete(ip_dec);
				printf("1) Output normale\n2) Output su file\nFai la tua scelta: ");
				scanf("%d", &scelta_file);
				switch(scelta_file){
					case 1:
						switch(tipo){
							case 0:
								creatore_sottoreti_a_variabile(ip_dec);
								break;
							case 1:
								creatore_sottoreti_b_variabile(ip_dec);
								break;
							case 2:
								creatore_sottoreti_c_variabile(ip_dec);
								break;
						}
						break;
					case 2:
						switch(tipo){
							case 0:
								creatore_sottoreti_a_variabile_file(ip_dec);
								break;
							case 1:
								creatore_sottoreti_b_variabile_file(ip_dec);
								break;
							case 2:
								creatore_sottoreti_c_variabile_file(ip_dec);
								break;
						}
						break;
					default:
						printf("Input non valido\n");
						break;
				}					
				break;			
			case 4:
				controllo_stessa_subnet();
				break;
			case 5:
				printf("Fine\n");
				fine = 1;
				break;
			default:
				printf("Input non valido\n");
				break;
		}
		getchar();
		printf("Premi un tasto per continuare...\n");
		getchar();
		clearscreen(); //Pulizia schermo
	}while(fine == 0);

    return 0;
}
